<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《图解 HTTP》 | 戡玉的个人博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="业精于勤荒于嬉，行成于思毁于随">
    
    <link rel="preload" href="/personal-blog/assets/css/0.styles.196d8624.css" as="style"><link rel="preload" href="/personal-blog/assets/js/app.742ab6e9.js" as="script"><link rel="preload" href="/personal-blog/assets/js/2.b85b6bc1.js" as="script"><link rel="preload" href="/personal-blog/assets/js/40.8d4dbb06.js" as="script"><link rel="prefetch" href="/personal-blog/assets/js/10.f48f662c.js"><link rel="prefetch" href="/personal-blog/assets/js/100.6f2f4394.js"><link rel="prefetch" href="/personal-blog/assets/js/101.80f8c9f9.js"><link rel="prefetch" href="/personal-blog/assets/js/102.e00d8b7f.js"><link rel="prefetch" href="/personal-blog/assets/js/103.533d0919.js"><link rel="prefetch" href="/personal-blog/assets/js/104.f1eba2ef.js"><link rel="prefetch" href="/personal-blog/assets/js/105.c9ad7b38.js"><link rel="prefetch" href="/personal-blog/assets/js/106.82063a6a.js"><link rel="prefetch" href="/personal-blog/assets/js/11.0480f4e3.js"><link rel="prefetch" href="/personal-blog/assets/js/12.c95be7c8.js"><link rel="prefetch" href="/personal-blog/assets/js/13.5f919469.js"><link rel="prefetch" href="/personal-blog/assets/js/14.4d9e7b7d.js"><link rel="prefetch" href="/personal-blog/assets/js/15.59786223.js"><link rel="prefetch" href="/personal-blog/assets/js/16.2d03551b.js"><link rel="prefetch" href="/personal-blog/assets/js/17.9c1bbe5e.js"><link rel="prefetch" href="/personal-blog/assets/js/18.52d35bcc.js"><link rel="prefetch" href="/personal-blog/assets/js/19.1b97ec1f.js"><link rel="prefetch" href="/personal-blog/assets/js/20.7877e85c.js"><link rel="prefetch" href="/personal-blog/assets/js/21.763a9d5e.js"><link rel="prefetch" href="/personal-blog/assets/js/22.34d7b15d.js"><link rel="prefetch" href="/personal-blog/assets/js/23.f3e8f17d.js"><link rel="prefetch" href="/personal-blog/assets/js/24.43f35153.js"><link rel="prefetch" href="/personal-blog/assets/js/25.8e862e53.js"><link rel="prefetch" href="/personal-blog/assets/js/26.d2ed036c.js"><link rel="prefetch" href="/personal-blog/assets/js/27.058b6e47.js"><link rel="prefetch" href="/personal-blog/assets/js/28.40578789.js"><link rel="prefetch" href="/personal-blog/assets/js/29.5371f7ff.js"><link rel="prefetch" href="/personal-blog/assets/js/3.c44793ab.js"><link rel="prefetch" href="/personal-blog/assets/js/30.642cb905.js"><link rel="prefetch" href="/personal-blog/assets/js/31.60dc52fc.js"><link rel="prefetch" href="/personal-blog/assets/js/32.16d411c1.js"><link rel="prefetch" href="/personal-blog/assets/js/33.2414377b.js"><link rel="prefetch" href="/personal-blog/assets/js/34.11dc0949.js"><link rel="prefetch" href="/personal-blog/assets/js/35.5f040c6c.js"><link rel="prefetch" href="/personal-blog/assets/js/36.489a05a3.js"><link rel="prefetch" href="/personal-blog/assets/js/37.f2c283a4.js"><link rel="prefetch" href="/personal-blog/assets/js/38.0dd475a2.js"><link rel="prefetch" href="/personal-blog/assets/js/39.e0560009.js"><link rel="prefetch" href="/personal-blog/assets/js/4.259d316e.js"><link rel="prefetch" href="/personal-blog/assets/js/41.f74b0db1.js"><link rel="prefetch" href="/personal-blog/assets/js/42.9defe1c9.js"><link rel="prefetch" href="/personal-blog/assets/js/43.797f934e.js"><link rel="prefetch" href="/personal-blog/assets/js/44.ce223a08.js"><link rel="prefetch" href="/personal-blog/assets/js/45.81dae8cd.js"><link rel="prefetch" href="/personal-blog/assets/js/46.ce784068.js"><link rel="prefetch" href="/personal-blog/assets/js/47.62458724.js"><link rel="prefetch" href="/personal-blog/assets/js/48.b33bff44.js"><link rel="prefetch" href="/personal-blog/assets/js/49.33be5536.js"><link rel="prefetch" href="/personal-blog/assets/js/5.deb8d1a0.js"><link rel="prefetch" href="/personal-blog/assets/js/50.e4bc82b5.js"><link rel="prefetch" href="/personal-blog/assets/js/51.85c8c5c8.js"><link rel="prefetch" href="/personal-blog/assets/js/52.09461adb.js"><link rel="prefetch" href="/personal-blog/assets/js/53.ebd19a8b.js"><link rel="prefetch" href="/personal-blog/assets/js/54.c5aa2b08.js"><link rel="prefetch" href="/personal-blog/assets/js/55.e0601249.js"><link rel="prefetch" href="/personal-blog/assets/js/56.d877a329.js"><link rel="prefetch" href="/personal-blog/assets/js/57.29bbb69f.js"><link rel="prefetch" href="/personal-blog/assets/js/58.963511d3.js"><link rel="prefetch" href="/personal-blog/assets/js/59.b90b8b20.js"><link rel="prefetch" href="/personal-blog/assets/js/6.3d2d0cab.js"><link rel="prefetch" href="/personal-blog/assets/js/60.e79f8383.js"><link rel="prefetch" href="/personal-blog/assets/js/61.9a9a6c56.js"><link rel="prefetch" href="/personal-blog/assets/js/62.63cc8398.js"><link rel="prefetch" href="/personal-blog/assets/js/63.629db0e5.js"><link rel="prefetch" href="/personal-blog/assets/js/64.389955bd.js"><link rel="prefetch" href="/personal-blog/assets/js/65.1dd3b877.js"><link rel="prefetch" href="/personal-blog/assets/js/66.ea2e8910.js"><link rel="prefetch" href="/personal-blog/assets/js/67.149d811b.js"><link rel="prefetch" href="/personal-blog/assets/js/68.c1757ccb.js"><link rel="prefetch" href="/personal-blog/assets/js/69.d2e460b3.js"><link rel="prefetch" href="/personal-blog/assets/js/7.e0031c86.js"><link rel="prefetch" href="/personal-blog/assets/js/70.ebccb665.js"><link rel="prefetch" href="/personal-blog/assets/js/71.7f1ecaa8.js"><link rel="prefetch" href="/personal-blog/assets/js/72.6dcd8d6b.js"><link rel="prefetch" href="/personal-blog/assets/js/73.6f87a303.js"><link rel="prefetch" href="/personal-blog/assets/js/74.cc12528e.js"><link rel="prefetch" href="/personal-blog/assets/js/75.b4bb49f1.js"><link rel="prefetch" href="/personal-blog/assets/js/76.2b539a88.js"><link rel="prefetch" href="/personal-blog/assets/js/77.c0a3cfcb.js"><link rel="prefetch" href="/personal-blog/assets/js/78.ba2007f8.js"><link rel="prefetch" href="/personal-blog/assets/js/79.5cd3bd9a.js"><link rel="prefetch" href="/personal-blog/assets/js/8.81c866d9.js"><link rel="prefetch" href="/personal-blog/assets/js/80.f72a7a66.js"><link rel="prefetch" href="/personal-blog/assets/js/81.be902852.js"><link rel="prefetch" href="/personal-blog/assets/js/82.0e1f9c97.js"><link rel="prefetch" href="/personal-blog/assets/js/83.5923885a.js"><link rel="prefetch" href="/personal-blog/assets/js/84.157c91d0.js"><link rel="prefetch" href="/personal-blog/assets/js/85.78dcfd22.js"><link rel="prefetch" href="/personal-blog/assets/js/86.23c160fc.js"><link rel="prefetch" href="/personal-blog/assets/js/87.66baf73e.js"><link rel="prefetch" href="/personal-blog/assets/js/88.9141c2ad.js"><link rel="prefetch" href="/personal-blog/assets/js/89.5b0908ed.js"><link rel="prefetch" href="/personal-blog/assets/js/9.db2e2a2e.js"><link rel="prefetch" href="/personal-blog/assets/js/90.69c2631a.js"><link rel="prefetch" href="/personal-blog/assets/js/91.f800de53.js"><link rel="prefetch" href="/personal-blog/assets/js/92.f4781d17.js"><link rel="prefetch" href="/personal-blog/assets/js/93.42786e19.js"><link rel="prefetch" href="/personal-blog/assets/js/94.4819fa84.js"><link rel="prefetch" href="/personal-blog/assets/js/95.2bf3439d.js"><link rel="prefetch" href="/personal-blog/assets/js/96.b64f24b5.js"><link rel="prefetch" href="/personal-blog/assets/js/97.dfec418f.js"><link rel="prefetch" href="/personal-blog/assets/js/98.24f20f66.js"><link rel="prefetch" href="/personal-blog/assets/js/99.be96186b.js">
    <link rel="stylesheet" href="/personal-blog/assets/css/0.styles.196d8624.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/personal-blog/" class="home-link router-link-active"><!----> <span class="site-name">戡玉的个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/personal-blog/life/" class="nav-link">
  生活
</a></div><div class="nav-item"><a href="/personal-blog/code/" class="nav-link router-link-active">
  技术
</a></div><div class="nav-item"><a href="/personal-blog/about/" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/personal-blog/life/" class="nav-link">
  生活
</a></div><div class="nav-item"><a href="/personal-blog/code/" class="nav-link router-link-active">
  技术
</a></div><div class="nav-item"><a href="/personal-blog/about/" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>文章</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>书籍</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/personal-blog/code/note/book/1.html" class="sidebar-link">《ECMAScript6 入门》</a></li><li><a href="/personal-blog/code/note/book/2.html" aria-current="page" class="active sidebar-link">《图解 HTTP》</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#web-网络基础" class="sidebar-link">web 网络基础</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#web-服务器" class="sidebar-link">web 服务器</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#http-协议-信息" class="sidebar-link">HTTP 协议/信息</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#http-状态-方法" class="sidebar-link">HTTP 状态/方法</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#http-报文" class="sidebar-link">HTTP 报文</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#http-首部" class="sidebar-link">HTTP 首部</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#https" class="sidebar-link">HTTPS</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#http-认证" class="sidebar-link">HTTP 认证</a></li><li class="sidebar-sub-header"><a href="/personal-blog/code/note/book/2.html#http-追加协议" class="sidebar-link">HTTP 追加协议</a></li></ul></li><li><a href="/personal-blog/code/note/book/3.html" class="sidebar-link">《你不知道的 javascript（上）》</a></li><li><a href="/personal-blog/code/note/book/4.html" class="sidebar-link">《高性能 javascript》</a></li><li><a href="/personal-blog/code/note/book/5.html" class="sidebar-link">《javascript 正则表达式迷你书》</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>专栏</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>文档</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>总结</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="《图解-http》"><a href="#《图解-http》" class="header-anchor">#</a> 《图解 HTTP》</h1> <h2 id="web-网络基础"><a href="#web-网络基础" class="header-anchor">#</a> web 网络基础</h2> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h3> <ul><li>Web 是建立在 HTTP（超文本传输协议）上通信的</li> <li>通常使用的网络（包括互联网）是在 TCP/IP 基础上运作的，HTTP 属于它的内部子集</li></ul> <h3 id="tcp-ip-协议"><a href="#tcp-ip-协议" class="header-anchor">#</a> TCP/IP 协议</h3> <h4 id="协议族"><a href="#协议族" class="header-anchor">#</a> 协议族</h4> <ul><li>计算机与网络设备要相互通信，需要基于一套通信规则，这种规则被称为协议（protocol）</li> <li>协议族包括：IP，TCP，FTP，UDP，HTTP，SNMP，ICMP，PPPoE 等等</li> <li>TCP/IP 是互联网相关各类协议族的总称</li></ul> <h4 id="分层管理"><a href="#分层管理" class="header-anchor">#</a> 分层管理</h4> <ul><li><p>应用层</p> <ul><li>向用户提供应用服务</li> <li>FTP，DNS 和 HTTP 属于该层</li></ul></li> <li><p>传输层</p> <ul><li>提供处于网络连接中的两台计算机之间的数据传输</li> <li>TCP 和 UDP 属于该层</li></ul></li> <li><p>网络层（网络互连层）</p> <ul><li>处理网络上的流动数据包</li> <li>数据包——网络传输的最小数据单位</li></ul></li> <li><p>链路层（数据链路层）</p> <ul><li>处理连接网络的硬件部分</li> <li>硬件设备（控制操作系统、设备驱动、网卡等）属于该层</li></ul></li></ul> <h4 id="通信传输流"><a href="#通信传输流" class="header-anchor">#</a> 通信传输流</h4> <p><img src="/code/note/book/1.png" alt=""></p> <ul><li>利用 TCP/IP 协议族进行网络通信时，会通过分层顺序与对方通信</li> <li>发送端，从应用层往下走；接收端，则从链路层往上走</li> <li>发送端，在层传输时会打上所属层的首部信息；接收端，则会将每层的首部消息消去</li> <li>HTTP 请求示例
<ul><li>客户端（游览器）在应用层（HTTP 协议）发送 Web 页面的 HTTP 请求</li> <li>传输层（TCP 协议）把从应用层收到的数据（HTTP 请求报文）进行分割，并在各个报文上打上标记序号及端口号后转发给网络层</li> <li>网络层（IP 协议）增加作为通信目的地的 MAC 地址，然后转发给链路层</li> <li>接收端（服务器）在链路层接收到数据，按序往上层发送，一直到应用层（才算接收成功）</li></ul></li></ul> <h3 id="dns"><a href="#dns" class="header-anchor">#</a> DNS</h3> <ul><li>职责
<ul><li>域名解析</li></ul></li> <li>位置
<ul><li>应用层</li></ul></li> <li>作用
<ul><li>提供域名到 IP 地址之间的解析服务</li></ul></li> <li>过程</li></ul> <p><img src="/code/note/book/2.png" alt=""></p> <h3 id="tcp"><a href="#tcp" class="header-anchor">#</a> TCP</h3> <ul><li>职责
<ul><li>确保可靠性</li></ul></li> <li>位置
<ul><li>传输层</li></ul></li> <li>作用
<ul><li>提供可靠的字节流服务（将大块数据分割成以报文段为单位）</li> <li>确保数据能到达目标</li></ul></li> <li>可靠性保证
<ul><li>三次握手</li></ul></li></ul> <p><img src="/code/note/book/3.png" alt=""></p> <h3 id="ip"><a href="#ip" class="header-anchor">#</a> IP</h3> <ul><li>职责
<ul><li>负责传输</li></ul></li> <li>位置
<ul><li>网络层</li></ul></li> <li>作用
<ul><li>把各种数据包传送给对方——涉及寻址，路由选择，网络转发</li> <li>负责分割和重编在传输层被分割的数据包</li></ul></li> <li>传输保证
<ul><li>必须满足各类条件（其中突出的有 IP 地址和 MAC 地址）</li></ul></li> <li>IP 地址/MAC 地址
<ul><li>IP 地址指明了节点被分配到的地址，MAC 地址是指网卡所属的固定地址</li> <li>IP 地址可以和 MAC 地址进行配对</li> <li>IP 间的通信依赖 MAC 地址</li></ul></li> <li>过程</li></ul> <p><img src="/code/note/book/4.png" alt=""></p> <h3 id="uri-url"><a href="#uri-url" class="header-anchor">#</a> URI/URL</h3> <h4 id="uri-统一资源标识符"><a href="#uri-统一资源标识符" class="header-anchor">#</a> URI——统一资源标识符</h4> <ul><li>用字符串标识某一互联网资源</li> <li>协议方案：http，ftp 和 tel 等</li> <li>表示指定 URI，需要涵盖全部必要信息的绝对 URI、绝对 URL 和相对 URL</li></ul> <p><img src="/code/note/book/5.png" alt=""></p> <h4 id="url-统一资源定位符"><a href="#url-统一资源定位符" class="header-anchor">#</a> URL——统一资源定位符</h4> <ul><li>互联网资源的地点</li></ul> <h3 id="过程"><a href="#过程" class="header-anchor">#</a> 过程</h3> <p><img src="/code/note/book/6.png" alt=""></p> <h2 id="web-服务器"><a href="#web-服务器" class="header-anchor">#</a> web 服务器</h2> <h3 id="概述-2"><a href="#概述-2" class="header-anchor">#</a> 概述</h3> <ul><li>一台 Web 服务器可搭建多个独立域名的 Web 网站</li> <li>可作为通信路径上的中转服务器提升传输效率</li></ul> <h3 id="实现多域名"><a href="#实现多域名" class="header-anchor">#</a> 实现多域名</h3> <ul><li>单台虚拟主机可以实现多个域名</li> <li>即使物理层面只有一台服务器，但只要使用虚拟主机的功能，则可以假想已具有多台服务器</li> <li>域名解析出的 ip 一致时，发送 HTTP 请求时，须在 Host 首部内完整指定主机名或域名的 URI</li></ul> <h3 id="通信数据转发"><a href="#通信数据转发" class="header-anchor">#</a> 通信数据转发</h3> <ul><li>HTTP 通信时，除客户端和服务器以外，还有一些用于通信数据转发的应用程序——代理、网关和隧道，它们配合服务器工作</li> <li>它们可以将请求转发给下一站服务器，并能接收服务器的响应转发给客户端</li></ul> <h4 id="代理"><a href="#代理" class="header-anchor">#</a> 代理</h4> <ul><li>转发功能的应用程序——负责转发请求给服务器，转发响应给客户端</li> <li>代理不改变请求 URI，会直接发送给前方持有资源的目标服务器</li> <li>每次通过代理服务器转发请求或响应时，会追加写入 Via 首部信息</li> <li>在 HTTP 通信过程中，代理服务器是多台级联的</li></ul> <p><img src="/code/note/book/7.png" alt=""></p> <ul><li>通过设置组织内部的代理服务器，可以针对特定 URL 做访问控制</li></ul> <p><img src="/code/note/book/8.png" alt=""></p> <ul><li>代理有两种基准分类：是否使用缓存，是否会修改报文</li> <li>缓存代理
<ul><li>代理转发响应时，会预先将资源副本保存在代理服务器上</li> <li>当再次接收到对相同资源请求时，就直接将之前的缓存资源作为响应返回</li></ul></li> <li>透明代理
<ul><li>转发请求或响应时，不对报文做任何加工</li> <li>反之，则被称为非透明代理</li></ul></li></ul> <h4 id="网关"><a href="#网关" class="header-anchor">#</a> 网关</h4> <p><img src="/code/note/book/9.png" alt=""></p> <ul><li>网关是转发其他服务器通信数据的服务器，接收客户端请求时，它就像源服务器一样处理请求</li> <li>网关的工作机制和代理十分相似</li> <li>网关能使通信线路上的服务器提供非 HTTP 协议服务</li> <li>网关能提高通信的安全性</li></ul> <h4 id="隧道"><a href="#隧道" class="header-anchor">#</a> 隧道</h4> <p><img src="/code/note/book/10.png" alt=""></p> <ul><li>隧道可按要求建立起一条与其他服务器的通信线路，届时使用 SSL 等加密手段进行通信</li> <li>隧道本身不会去解析 HTTP 请求，而是原样中转给服务器</li> <li>隧道本身是透明的，客户端不用在意隧道的存在</li></ul> <h3 id="保存资源的缓存"><a href="#保存资源的缓存" class="header-anchor">#</a> 保存资源的缓存</h3> <h4 id="类型"><a href="#类型" class="header-anchor">#</a> 类型</h4> <ul><li>缓存服务器（代理服务器的一种）对响应资源的缓存</li> <li>客户端对响应资源的缓存（本地磁盘上）</li></ul> <h4 id="有效期"><a href="#有效期" class="header-anchor">#</a> 有效期</h4> <ul><li>若浏览器判断缓存失效，则会再次向服务器请求新资源</li> <li>即使缓存服务器存在缓存，因为客户端的要求、缓存的有效期等因素，还是会向源服务器确认，及时请求，更新资源</li></ul> <h2 id="http-协议-信息"><a href="#http-协议-信息" class="header-anchor">#</a> HTTP 协议/信息</h2> <h3 id="概述-3"><a href="#概述-3" class="header-anchor">#</a> 概述</h3> <ul><li>应用 HTTP 协议时，必定是一端担任客户端角色，另一端担任服务器端角色</li> <li>HTTP 协议，用于客户端和服务器端之间的通信，两者通过请求和响应的交换达成通信</li> <li>HTTP 协议，自身不对请求和响应之间的通信状态进行保存，cookie 用于满足这个需求</li> <li>HTTP 协议，使用 URI（统一资源标识符）让客户端定位互联网上的资源</li></ul> <h3 id="uri-定位资源"><a href="#uri-定位资源" class="header-anchor">#</a> URI 定位资源</h3> <p><img src="/code/note/book/11.png" alt=""></p> <h4 id="请求-uri-的方式"><a href="#请求-uri-的方式" class="header-anchor">#</a> 请求 URI 的方式</h4> <p><img src="/code/note/book/12.png" alt=""></p> <h3 id="内容编码"><a href="#内容编码" class="header-anchor">#</a> 内容编码</h3> <ul><li>HTTP 协议中有一种<strong>内容编码功能</strong>，负责对实体信息进行原样压缩</li> <li>内容编码，指明了应用在实体内容上的编码格式</li> <li>内容编码后的实体，由客户端接收并负责解码</li> <li>常用的内容编码——gzip，compress，deflate，identity（不进行编码）</li> <li>对于大的实体主体会进行<strong>分块传输编码</strong></li></ul> <h3 id="多部分对象集合"><a href="#多部分对象集合" class="header-anchor">#</a> 多部分对象集合</h3> <ul><li>HTTP 协议采纳多部分对象集合机制（MIME），用于容纳多份（发送多种）不同类型的数据</li> <li>包含对象
<ul><li>multipart/form-data——Web 表单文件上传时使用</li> <li>multipart/byteranges——包含多个范围的内容时使用</li></ul></li></ul> <h3 id="范围请求"><a href="#范围请求" class="header-anchor">#</a> 范围请求</h3> <ul><li>获取部分内容的请求被称为范围请求，也就是继续未完成内容的一种请求形式</li> <li>执行范围请求时，会用到首部字段 Range 来指定资源的 byte 范围</li> <li>如果服务器端无法响应范围请求，则会直接返回 200 和完整实体内容</li></ul> <h3 id="内容协商机制"><a href="#内容协商机制" class="header-anchor">#</a> 内容协商机制</h3> <ul><li>指客户端和服务器端就响应资源内容进行交涉，然后提供给客户端最为适合的资源</li> <li>内容协商会以响应资源的语言、字符集、编码方式等作为判断的基准</li> <li>包含在请求报文中的某些<strong>首部字段</strong>就是判断的基准
<ul><li>Accept</li> <li>Accept-Charset</li> <li>Accept-Encoding</li> <li>Accept-Language</li> <li>Content-Language</li></ul></li> <li>内容协商技术
<ul><li>服务器驱动协商（Server-driven Negotiation）
<ul><li>以请求的首部字段为参考，在服务器端自动处理</li></ul></li> <li>客户端驱动协商（Agent-driven Negotiation）
<ul><li>用户从浏览器显示的可选项列表中手动选择</li> <li>开发者利用 js 脚本在页面上自行选择</li></ul></li> <li>透明协商（Transparent Negotiation）
<ul><li>由服务器端和客户端各自进行内容协商</li></ul></li></ul></li></ul> <h2 id="http-状态-方法"><a href="#http-状态-方法" class="header-anchor">#</a> HTTP 状态/方法</h2> <h3 id="类别"><a href="#类别" class="header-anchor">#</a> 类别</h3> <table><thead><tr><th style="text-align:left;"></th> <th style="text-align:left;">类别</th> <th style="text-align:left;">原因短语</th></tr></thead> <tbody><tr><td style="text-align:left;">1XX</td> <td style="text-align:left;">Informational（信息性状态码）</td> <td style="text-align:left;">接收的请求正在处理</td></tr> <tr><td style="text-align:left;">2XX</td> <td style="text-align:left;">Success（成功状态码）</td> <td style="text-align:left;">请求正常处理完毕</td></tr> <tr><td style="text-align:left;">3XX</td> <td style="text-align:left;">Redirection（重定向状态码）</td> <td style="text-align:left;">需要进行附加操作以完成请求</td></tr> <tr><td style="text-align:left;">4XX</td> <td style="text-align:left;">Client Error（客户端错误状态码）</td> <td style="text-align:left;">服务器无法处理请求</td></tr> <tr><td style="text-align:left;">5XX</td> <td style="text-align:left;">Server Error（服务器错误状态码）</td> <td style="text-align:left;">服务器处理请求出错</td></tr></tbody></table> <h4 id="_2xxx-成功"><a href="#_2xxx-成功" class="header-anchor">#</a> 2xxx（成功）</h4> <table><thead><tr><th style="text-align:left;">状态码</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">补充</th></tr></thead> <tbody><tr><td style="text-align:left;">200</td> <td style="text-align:left;">请求被正常处理</td> <td style="text-align:left;">返回的信息会因 method 不同而有所改变</td></tr> <tr><td style="text-align:left;">204</td> <td style="text-align:left;">请求处理成功，但无资源返回</td> <td style="text-align:left;">不允许返回任何实体的主体</td></tr> <tr><td style="text-align:left;">206</td> <td style="text-align:left;">成功处理了范围请求</td> <td style="text-align:left;">响应报文中返回由 Content-Range 指定范围的内容</td></tr></tbody></table> <h4 id="_3xxx-重定向"><a href="#_3xxx-重定向" class="header-anchor">#</a> 3xxx（重定向）</h4> <table><thead><tr><th style="text-align:left;">状态码</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">补充</th></tr></thead> <tbody><tr><td style="text-align:left;">301</td> <td style="text-align:left;">永久性重定向</td> <td style="text-align:left;">表示请求的资源已被分配了新的 URI</td></tr> <tr><td style="text-align:left;">302</td> <td style="text-align:left;">临时性重定向</td> <td style="text-align:left;">已移动的资源对应的 URI 将来还会发生改变</td></tr> <tr><td style="text-align:left;">303</td> <td style="text-align:left;">临时性建议重定向</td> <td style="text-align:left;">请求资源存在另一个 URI，应使用 GET 方法定向获取</td></tr> <tr><td style="text-align:left;">304</td> <td style="text-align:left;">没有修改</td> <td style="text-align:left;">资源已找到，但未符合条件请求</td></tr> <tr><td style="text-align:left;">307</td> <td style="text-align:left;">临时重定向</td> <td style="text-align:left;">遵照浏览器标准，不会从 POST 变成 GET，302 则不会</td></tr></tbody></table> <h4 id="_4xxx-客户端错误"><a href="#_4xxx-客户端错误" class="header-anchor">#</a> 4xxx（客户端错误）</h4> <table><thead><tr><th style="text-align:left;">状态码</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">补充</th></tr></thead> <tbody><tr><td style="text-align:left;">400</td> <td style="text-align:left;">服务器不理解请求</td> <td style="text-align:left;">表示请求报文中存在语法错误</td></tr> <tr><td style="text-align:left;">401</td> <td style="text-align:left;">需要 HTTP 认证信息</td> <td style="text-align:left;">1.响应必须包含一个 WWW-Authenticate 首部用以质询用户信息 <br> 2.当浏览器初次接收到 401 响应，会弹出认证用的对话窗口</td></tr> <tr><td style="text-align:left;">403</td> <td style="text-align:left;">服务器拒绝请求</td> <td style="text-align:left;">服务器端对于拒绝理由可附在实体主体部分</td></tr> <tr><td style="text-align:left;">404</td> <td style="text-align:left;">未找到资源</td> <td style="text-align:left;">也可在服务器端拒绝请求且不想说明理由时使用</td></tr></tbody></table> <h4 id="_5xxx-服务器错误"><a href="#_5xxx-服务器错误" class="header-anchor">#</a> 5xxx（服务器错误）</h4> <table><thead><tr><th style="text-align:left;">状态码</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">补充</th></tr></thead> <tbody><tr><td style="text-align:left;">500</td> <td style="text-align:left;">服务器内部错误</td> <td style="text-align:left;">服务端处理请求发生错误，或 Web 应用存在 bug 或临时故障</td></tr> <tr><td style="text-align:left;">502</td> <td style="text-align:left;">错误网关</td> <td style="text-align:left;">服务器作为网关或代理，从上游服务器收到无效响应</td></tr> <tr><td style="text-align:left;">503</td> <td style="text-align:left;">服务器暂停服务</td> <td style="text-align:left;">-</td></tr> <tr><td style="text-align:left;">504</td> <td style="text-align:left;">网关超时</td> <td style="text-align:left;">服务器作为网关或代理，但是没有及时从上游服务器收到请求</td></tr></tbody></table> <h3 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h3> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:left;">说明</th> <th style="text-align:left;">详细</th></tr></thead> <tbody><tr><td style="text-align:left;">GET</td> <td style="text-align:left;">获取资源</td> <td style="text-align:left;">-</td></tr> <tr><td style="text-align:left;">POST</td> <td style="text-align:left;">传输实体主体</td> <td style="text-align:left;">-</td></tr> <tr><td style="text-align:left;">PUT</td> <td style="text-align:left;">传输文件</td> <td style="text-align:left;">1.在 HTTP/1.1 中不带验证机制，存在安全性问题 <br> 2.配合 web 应用验证机制和 REST 标准可以使用 <br> 3.较少使用</td></tr> <tr><td style="text-align:left;">DELETE</td> <td style="text-align:left;">删除文件</td> <td style="text-align:left;">同上</td></tr> <tr><td style="text-align:left;">HEAD</td> <td style="text-align:left;">获得报文首部</td> <td style="text-align:left;">1.和 GET 一样，只是不返回报文主体 <br> 2.用于确认 URI 的有效性及资源更新的日期时间等</td></tr> <tr><td style="text-align:left;">OPTIONS</td> <td style="text-align:left;">询问支持的 HTTP 方法</td> <td style="text-align:left;">-</td></tr> <tr><td style="text-align:left;">TRACE</td> <td style="text-align:left;">追踪路径</td> <td style="text-align:left;">1.让 Web 服务端将之前的请求通信环回给客户端 <br> 2.容易引发 XST（跨站追踪）攻击</td></tr> <tr><td style="text-align:left;">CONNECT         </td> <td style="text-align:left;">要求用隧道协议连接代理</td> <td style="text-align:left;">1.要求与代理服务器通信时建立隧道，实现用隧道协议进行 TCP 通信 <br> 2.主要使用 SSL（安全套接层）和 TLS（传输层安全）协议，把通信内容加密后，经网络隧道传输</td></tr></tbody></table> <h2 id="http-报文"><a href="#http-报文" class="header-anchor">#</a> HTTP 报文</h2> <h3 id="概述-4"><a href="#概述-4" class="header-anchor">#</a> 概述</h3> <ul><li>用于 HTTP 协议交互的信息被称为 HTTP 报文</li> <li>客户端的报文叫请求报文，服务器端的报文叫响应报文</li> <li>大致分为报文首部和报文主体两块</li></ul> <h3 id="报文结构"><a href="#报文结构" class="header-anchor">#</a> 报文结构</h3> <p><img src="/code/note/book/13.png" alt=""></p> <p><img src="/code/note/book/14.png" alt=""></p> <h3 id="请求报文"><a href="#请求报文" class="header-anchor">#</a> 请求报文</h3> <ul><li>由方法、URI、HTTP 协议版本、请求首部字段和内容实体构成</li></ul> <p><img src="/code/note/book/15.png" alt=""></p> <h3 id="响应报文"><a href="#响应报文" class="header-anchor">#</a> 响应报文</h3> <ul><li>由 HTTP 协议版本、状态码，状态码原因短语、响应首部字段和响应主体构成</li></ul> <p><img src="/code/note/book/16.png" alt=""></p> <h3 id="报文主体和实体主体"><a href="#报文主体和实体主体" class="header-anchor">#</a> 报文主体和实体主体</h3> <ul><li>报文——HTTP 通信中的基本单位，由 8 位组字节流组成</li> <li>实体——作为请求/响应的有效载荷数据被传输，由实体首部和实体主体组成</li> <li>报文主体，用于传输请求或响应的实体主体</li> <li>通常来说，报文主体等于实体主体</li> <li>只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异</li></ul> <h2 id="http-首部"><a href="#http-首部" class="header-anchor">#</a> HTTP 首部</h2> <ul><li>因 HTTP 版本或扩展规范的变化，首部字段可支持的字段内容略有不同，这里主要涉及 HTTP/1.1 及常用的首部字段</li> <li>HTTP 首部字段是可以自行扩展的。所以在 Web 服务器和浏览器的应用上，存在各种非标准的首部字段</li></ul> <h3 id="http-首部字段"><a href="#http-首部字段" class="header-anchor">#</a> HTTP 首部字段</h3> <h4 id="通用分类"><a href="#通用分类" class="header-anchor">#</a> 通用分类</h4> <table><thead><tr><th style="text-align:left;">类型</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">补充</th></tr></thead> <tbody><tr><td style="text-align:left;">通用首部字段</td> <td style="text-align:left;">请求和响应都会用到的首部</td> <td style="text-align:left;">-</td></tr> <tr><td style="text-align:left;">请求首部字段</td> <td style="text-align:left;">客户端向服务器端发送请求报文时使用的首部</td> <td style="text-align:left;">补充了请求的附加内容、客户端信息、响应内容相关优先级等信息</td></tr> <tr><td style="text-align:left;">响应首部字段</td> <td style="text-align:left;">客户端向服务器端发送请求报文时使用的首部</td> <td style="text-align:left;">补充了响应的附加内容，也会要求客户端附加额外的内容信息</td></tr> <tr><td style="text-align:left;">实体首部字段</td> <td style="text-align:left;">客户端向服务器端发送请求报文时使用的首部</td> <td style="text-align:left;">补充了资源内容更新时间等与实体有关的信息</td></tr></tbody></table> <h4 id="按缓存代理分类"><a href="#按缓存代理分类" class="header-anchor">#</a> 按缓存代理分类</h4> <ul><li><p>HTTP 首部字段将定义成缓存代理和非缓存代理的行为，分成 2 种类型</p></li> <li><p>逐跳首部（Hop-by-hop）</p> <ul><li>只对单次转发有效</li> <li>会因通过缓存或代理而不再转发</li> <li>HTTP/1.1+版本开始，逐跳首部首部的使用，需提供 Connection 首部字段</li> <li>包含的首部：Connection，Keep-Alive，Proxy-Authenticate，Proxy-Authorization，Trailer，TE，Transfer-Encoding，Upgrade</li></ul></li> <li><p>端到端首部（End-to-end）</p> <ul><li>必须被转发</li> <li>会转发给请求/响应对应的最终接收目标</li> <li>必须保存在由缓存生成的响应中</li> <li>包含的首部：其他所有</li></ul></li></ul> <h3 id="通用首部字段"><a href="#通用首部字段" class="header-anchor">#</a> 通用首部字段</h3> <p><img src="/code/note/book/17.png" alt=""></p> <ul><li><p>Connection</p> <ul><li>控制不再转发给代理的首部字段
<ul><li>在客户端发送请求和服务器返回响应内，可控制不再转发给代理的首部字段</li> <li>Connection: 不再转发的首部字段名</li></ul></li> <li>管理持久连接
<ul><li>HTTP/1.1 版本的默认连接都是持久连接，当服务器端想明确断开连接时，则指定 Connection 首部字段的值为 Close</li> <li>HTTP/1.1 之前的 HTTP 版本的默认连接都是非持久连接，想维持持续连接，则需要指定 Connection 首部字段的值为 Keep-Alive</li></ul></li></ul></li> <li><p>Date</p> <ul><li>表明创建 HTTP 报文的日期和时间</li></ul></li> <li><p>Pragma</p> <ul><li>Pragma 是 HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0 的向后兼容而定义</li> <li>规范定义的形式唯一 Pragma: no-cache，并且只用在客户端发送的请求中</li> <li>为了 http 版本的整体兼顾，通常会同时含有 Cache-Control: no-cache 和 Pragma: no-cache</li></ul></li> <li><p>Trailer</p> <ul><li>表明在报文主体后记录了哪些首部字段</li> <li>应用在 HTTP/1.1 版本分块传输编码时</li></ul></li> <li><p>Transfer-Encoding</p> <ul><li>规定了传输报文主体时采用的编码方式</li> <li>HTTP/1.1 的传输编码方式，仅对分块传输编码有效</li></ul></li> <li><p>Upgrade</p> <ul><li>用于检测 HTTP 协议及其他协议是否可使用更高的版本进行通信</li> <li>参数值可以用来指定一个完全不同的通信协议</li> <li>对于附有首部字段 Upgrade 的请求，服务器可用 101 Switching Protocols 状态码作为响应</li></ul></li> <li><p>Via</p> <ul><li>用于追踪客户端与服务器之间的请求和响应报文的传输路径</li> <li>报文经过代理或网关时，会先在首部字段 Via 中附加该服务器的信息，然后再进行转发</li> <li>Via 不仅用于追踪报文的转发，还可避免请求回环的发生，因此必须在经过代理时附加该首部字段内容</li></ul></li></ul> <p><img src="/code/note/book/18.png" alt=""></p> <ul><li>Warning
<ul><li>告知用户一些与缓存相关的问题的警告</li> <li>格式：Warning: [警告码][警告的主机:端口号]“[警告内容]”([日期时间])</li> <li>警告码具备扩展性，今后有可能追加新的警告码</li> <li>HTTP/1.1 中定义了 7 种警告</li></ul></li></ul> <p><img src="/code/note/book/19.png" alt=""></p> <h3 id="请求首部字段"><a href="#请求首部字段" class="header-anchor">#</a> 请求首部字段</h3> <p><img src="/code/note/book/20.png" alt=""></p> <ul><li><p>Accept</p> <ul><li>告知服务器，用户代理能够处理的<strong>媒体类型</strong>及媒体类型的相对优先级</li> <li>可使用 type/subtype 这种形式，一次指定多种媒体类型</li> <li>若想要给显示的媒体类型增加优先级，则使用 q=来额外表示权重值，用分号（;）进行分隔，权重值 q 的范围是 0~1，不指定权重 q 值时，默认权重为 q=1.0</li></ul></li> <li><p>Accept-Charset</p> <ul><li>告知服务器，用户代理支持的<strong>字符集</strong>及字符集的相对优先顺序</li> <li>可一次性指定多种字符集</li> <li>与首部字段 Accept 相同的是，按权重值 q 来表示相对优先级</li></ul></li> <li><p>Accept-Encoding</p> <ul><li>告知服务器，用户代理支持的<strong>内容编码</strong>及内容编码的优先级顺序</li> <li>可一次性指定多种内容编码</li> <li>与首部字段 Accept 相同的是，按权重值 q 来表示相对优先级</li> <li>可使用星号（*）作为通配符，指定任意的编码格式</li></ul></li> <li><p>Accept-Language</p> <ul><li>告知服务器，用户代理能够处理的<strong>自然语言集</strong>及自然语言集的相对优先级</li> <li>可一次指定多种自然语言集</li> <li>与首部字段 Accept 相同的是，按权重值 q 来表示相对优先级</li></ul></li> <li><p>Authorization</p> <ul><li>告知服务器，用户代理的认证信息（证书值）</li> <li>通常，想要通过服务器认证的用户代理会在接收到返回的 401 状态码响应后，把首部字段 Authorization 加入请求中</li> <li>共用缓存在接收到含有 Authorization 首部字段的请求时的操作处理会略有差异</li></ul></li> <li><p>Expect</p> <ul><li>告知服务器，期望出现的某种特定行为</li> <li>因服务器无法理解客户端的期望作出回应而发生错误时，会返回状态码 417 Expectation Failed</li></ul></li> <li><p>From</p> <ul><li>告知服务器，使用用户代理的用户的电子邮件地址</li> <li>通常其使用目的就是为了显示搜索引擎等用户代理的负责人的电子邮件联系方式</li> <li>使用代理时，应尽可能包 From 首部字段（但可能会因代理不同，将电子邮件地址记录在 User-Agent 首部字段内）</li></ul></li> <li><p>Host</p> <ul><li>告知服务器，请求的资源所处的互联网主机名和端口号</li> <li>Host 首部字段在 HTTP/1.1 规范内是唯一一个必须被包含在请求内的首部字段</li> <li>由于相同 IP 地址下可能部署运行着多个域名，可通过 host 字段来理解域名对应的请求</li></ul></li> <li><p>If-Match</p> <ul><li>形如 If-xxx 这种样式的请求首部字段，都可称为条件请求</li> <li>服务器接收到附带条件的请求后，只有判断指定条件为真时，才会执行请求</li> <li>服务器会比对 If-Match 的字段值和资源的 ETag 值，仅当两者一致时，才会执行请求</li> <li>可以使用星号（*）指定 If-Match 的字段值,服务器将会忽略 ETag 的值，只要资源存在就处理请求</li></ul></li> <li><p>If-None-Match</p> <ul><li>与 If-Match 首部字段的作用相反</li> <li>只有在 If-None-Match 字段值与 ETag 值不一致时，才告知服务器处理该请求</li> <li>在 GET 或 HEAD 方法中使用首部字段 If-None-Match 可获取最新的资源</li></ul></li> <li><p>If-Modified-Since</p> <ul><li>该字段指定的日期时间后，如果资源发生了更新，服务器会接受请求；反之，则返回 304 响应</li> <li>用于确认代理或客户端拥有的本地资源的有效性</li> <li>获取资源的更新日期时间，可通过确认首部字段 Last-Modified 来确定</li></ul></li> <li><p>If-Unmodified-Since</p> <ul><li>与 If-Modified-Since 的作用相反</li> <li>告知服务器，指定的请求资源只有在字段值内指定的日期时间之后，未发生更新的情况下，才能处理请求</li> <li>如果在指定日期时间后发生了更新，则以状态码 412 Precondition Failed 作为响应
返回</li></ul></li> <li><p>Range</p> <ul><li>可告知服务器资源的指定范围，用于获取部分资源的范围请求</li> <li>接收到附带 Range 首部字段请求的服务器，会在处理请求之后返回状态码为 206 Partial Content 的响应；</li> <li>服务器无法处理范围请求时，则返回全部</li></ul></li> <li><p>If-Range</p> <ul><li>告知服务器若 If-Range 字段值（ETag 值或时间）和请求资源的 ETag 值或时间相一
致时，则作为范围请求处理。反之，则返回全体资源</li> <li>服务器端的资源如果更新，那客户端持有资源中的一部分也会随之无效，服务器会要求客户端重新请求，以返回全部最新的资源。这种情况下，客户端需要 2 次请求才能更新资源</li></ul></li> <li><p>Max-Forwards</p> <ul><li>该字段以十进制整数形式指定可经过的服务器最大数目</li> <li>没转发一次请求，该字段值减 1，当值为 0 是，不再转发，直接响应</li> <li>可以一定程度掌握传输路径的通信状况</li></ul></li> <li><p>Proxy-Authorization</p> <ul><li>接收到从代理服务器发来的认证质询时，客户端会发送包含首部字段
Proxy-Authorization 的请求，以告知服务器认证所需要的信息</li> <li>与客户端和服务器之间的 HTTP 访问认证相类似，不同之处在于，认证行为发生在客户端与代理之间</li></ul></li> <li><p>Referer</p> <ul><li>告知服务器，请求的原始资源的 URI</li></ul></li> <li><p>TE</p> <ul><li>告知服务器，客户端能够处理响应的传输编码方式及相对优先级</li> <li>和首部字段 Accept-Encoding 的功能很相像，但是用于传输编码</li> <li>还可以指定伴随 trailer 字段的分块传输编码的方式</li></ul></li> <li><p>User-Agent</p> <ul><li>用于传达浏览器的种类</li> <li>会将创建请求的浏览器和用户代理名称等信息传达给服务器</li></ul></li></ul> <h3 id="响应首部字段"><a href="#响应首部字段" class="header-anchor">#</a> 响应首部字段</h3> <p><img src="/code/note/book/21.png" alt=""></p> <ul><li><p>Accept-Ranges</p> <ul><li>告知客户端，服务器是否能处理范围请求</li> <li>可指定的字段值有两种，可处理范围请求时指定其为 bytes，反之则为 none</li></ul></li> <li><p>Age</p> <ul><li>告知客户端，源服务器在多久前响应过</li> <li>字段值的单位为秒</li> <li>若创建该响应的服务器是缓存服务器，Age 值是指缓存后的响应再次发起认证到认证完成的时间值</li> <li>代理创建响应时必须加上首部字段 Age</li></ul></li> <li><p>ETag</p> <ul><li>告知客户端，实体标识——1 种可将资源以字符串形式做唯一性标识的方式</li> <li>服务器会为每份资源分配对应的 ETag 值</li> <li>当资源更新时，ETag 值也需要更新</li> <li>资源被缓存时，就会被分配唯一性标识</li> <li>ETag 中有强 ETag 值和弱 ETag 值之分
<ul><li>强 ETag 值，不论实体发生多么细微的变化都会改变其值</li> <li>弱 ETag 值，只用于提示资源是否相同。只有资源发生了根本改变，产生差异时才会改变 ETag 值</li></ul></li></ul></li> <li><p>Location</p> <ul><li>将响应接收方引导至某个与请求 URI 位置不同的资源（重定向）</li> <li>几乎所有的浏览器在接收到包含首部字段 Location 的响应后，都会强制性地尝试对已提示的重定向资源的访问</li></ul></li></ul> <h3 id="实体首部字段"><a href="#实体首部字段" class="header-anchor">#</a> 实体首部字段</h3> <p><img src="/code/note/book/22.png" alt=""></p> <h3 id="cache-control-首部字段"><a href="#cache-control-首部字段" class="header-anchor">#</a> Cache-Control 首部字段</h3> <h4 id="概述-5"><a href="#概述-5" class="header-anchor">#</a> 概述</h4> <ul><li>通过使用首部字段 Cache-Control 能够控制缓存的行为，用于请求和响应时</li> <li>Cache-Control 指令的参数是可选的，多个指令之间通过“,”分隔</li></ul> <div class="language- extra-class"><pre class="language-text"><code>    Cache-Control: private, max-age=0, no-cache
</code></pre></div><h4 id="cache-control-指令一览"><a href="#cache-control-指令一览" class="header-anchor">#</a> Cache-Control 指令一览</h4> <p><img src="/code/note/book/23.png" alt=""></p> <p><img src="/code/note/book/24.png" alt=""></p> <h4 id="表示是否能缓存的指令"><a href="#表示是否能缓存的指令" class="header-anchor">#</a> 表示是否能缓存的指令</h4> <ul><li>public
<ul><li>表明其他用户也可利用缓存</li></ul></li> <li>private
<ul><li>只对特定用户提供资源缓存服务</li></ul></li> <li>no-cache
<ul><li>防止从缓存中返回过期的资源</li> <li>由客户端发出，强制向源服务器验证，不接收缓存服务器的缓存响应</li> <li>由服务器返回，源服务器不再向缓存服务器确认资源有效性，缓存服务器不能对资源进行缓存</li> <li>如果服务器对 no-cache 设置参数值，则客户端被禁止使用缓存</li></ul></li></ul> <h4 id="控制可执行缓存的对象的指令"><a href="#控制可执行缓存的对象的指令" class="header-anchor">#</a> 控制可执行缓存的对象的指令</h4> <ul><li>no-store
<ul><li>该指令规定，缓存不能在本地存储请求或响应的任一部分</li> <li>使用 no-store 指令，暗示请求或响应中包含机密信息</li> <li>no-cache 代表不缓存过期的资源，no-store 才是真正地不进行缓存</li></ul></li></ul> <h4 id="指定缓存期限和认证的指令"><a href="#指定缓存期限和认证的指令" class="header-anchor">#</a> 指定缓存期限和认证的指令</h4> <ul><li>s-maxage
<ul><li>只适用于供多位用户使用的公共缓存服务器</li> <li>使用 s-maxage 指令后，会忽略对 Expires 首部字段及 max-age 指令处理</li></ul></li> <li>max-age
<ul><li>由客户端发出，判定缓存资源的缓存时间数值小于指定时间，客户端就接收缓存资源</li> <li>由服务器返回，缓存服务器将不对资源的有效性再作确认</li></ul></li> <li>min-fresh
<ul><li>要求缓存服务器返回至少还未过指定时间的缓存资源</li></ul></li> <li>max-stale
<ul><li>指示缓存资源，即使过期也照常接收</li> <li>如果指令未指定参数值，那么无论经过多久，客户端都会接收响应</li> <li>如果指令中指定参数值，那么即使过期，只要仍处于 max-stale 的指定时间内，仍旧会被客户端接收</li></ul></li> <li>only-if-cached
<ul><li>表示客户端仅在缓存服务器本地缓存目标资源的情况下才会要求其返回</li> <li>该指令要求缓存服务器不重新加载响应，也不会再次确认资源有效性</li> <li>若发生请求缓存服务器的本地缓存无响应，则返回状态码 504 Gateway Timeout</li></ul></li> <li>must-revalidate
<ul><li>代理会向源服务器再次验证即将返回的响应缓存目前是否仍然有效</li> <li>若代理无法连通源服务器再次获取有效资源的话，缓存必须给客户端一条 504 状态码</li> <li>使用 must-revalidate 指令会忽略请求的 max-stale 指令</li></ul></li> <li>proxy-revalidate
<ul><li>要求所有缓存服务器在接收到客户端带有该指令的请求返回响应之前，必须再次验证缓存的有效性</li></ul></li> <li>no-transform
<ul><li>无论是在请求还是响应中，缓存都不能改变实体主体的媒体类型</li> <li>可防止缓存或代理压缩图片等类似操作</li></ul></li></ul> <h3 id="cookie-相关首部字段"><a href="#cookie-相关首部字段" class="header-anchor">#</a> Cookie 相关首部字段</h3> <ul><li>Set-Cookie
<ul><li>多字段属性使用</li> <li>字段属性列表如下</li></ul></li></ul> <table><thead><tr><th style="text-align:left;">属性</th> <th style="text-align:left;">说明</th></tr></thead> <tbody><tr><td style="text-align:left;">NAME=VALUE</td> <td style="text-align:left;">赋予 Cookie 的名称和其值（必需项）</td></tr> <tr><td style="text-align:left;">expires=DATE</td> <td style="text-align:left;">Cookie 的有效期（若不明确指定则默认为浏览器关闭前为止）</td></tr> <tr><td style="text-align:left;">path=PATH</td> <td style="text-align:left;">将服务器上的文件目录作为 Cookie 的适用对象（若不指定则默认为文档所在的文件目录</td></tr> <tr><td style="text-align:left;">domain=域名</td> <td style="text-align:left;">作为 Cookie 适用对象的域名 （若不指定则默认为创建 Cookie 的服务器的域名）</td></tr> <tr><td style="text-align:left;">Secure</td> <td style="text-align:left;">仅在 HTTPS 安全通信时才会发送 Cookie</td></tr> <tr><td style="text-align:left;">HttpOnly</td> <td style="text-align:left;">加以限制，使 Cookie 不能被 JavaScript 脚本访问</td></tr></tbody></table> <ul><li>Cookie
<ul><li>接收到多个 Cookie 时，同样可以以多个 Cookie 形式发送</li></ul></li></ul> <h3 id="其他首部字段"><a href="#其他首部字段" class="header-anchor">#</a> 其他首部字段</h3> <ul><li><p>X-Frame-Options</p> <ul><li>属于 HTTP 响应首部</li> <li>主要用于防止<strong>点击劫持</strong>攻击</li> <li>控制网站内容在其他 Web 网站的 Frame 标签内的显示问题</li> <li>可指定 2 个字段值
<ul><li>DENY：拒绝</li> <li>SAMEORIGIN：仅同源域名下的页面</li></ul></li></ul></li> <li><p>X-XSS-Protection</p> <ul><li>属于 HTTP 响应首部</li> <li>主要用于防止<strong>跨站脚本攻击</strong>（XSS）</li> <li>用于控制浏览器 XSS 防护机制的开关</li> <li>可指定 2 个字段值
<ul><li>0：将 XSS 过滤设置成无效状态</li> <li>1：将 XSS 过滤设置成有效状态</li></ul></li></ul></li> <li><p>DNT</p> <ul><li>属于 HTTP 请求首部</li> <li>意为拒绝个人信息被收集</li> <li>表示拒绝被精准广告追踪的一种方法</li> <li>可指定 2 个字段值
<ul><li>0：同意被追踪</li> <li>1：拒绝被追踪</li></ul></li></ul></li> <li><p>P3P</p> <ul><li>属于 HTTP 响应首部</li> <li>主要用于保护用户隐私</li> <li>利用 P3P 技术让个人隐私变得仅供程序理解</li> <li>实现步骤
<ul><li>步骤 1：创建 P3P 隐私</li> <li>步骤 2：创建 P3P 隐私对照文件后，保存命名在/w3c/p3p.xml</li> <li>步骤 3：从 P3P 隐私中新建 Compact policies 后，输出到 HTTP 响应中</li></ul></li></ul></li></ul> <h2 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h2> <ul><li>解决通信安全问题</li></ul> <h3 id="http-缺点"><a href="#http-缺点" class="header-anchor">#</a> HTTP 缺点</h3> <ul><li><p>通信使用明文，内容可能会被窃听</p> <ul><li><p>解决办法</p> <ul><li><p>HTTP 通信加密 =&gt; 使用 SSL 建立安全通信线路</p></li> <li><p>报文内容加密 =&gt; 客户端和服务端统一套内容的加密/解密机制</p></li></ul></li></ul></li> <li><p>不验证通信方的身份，因此有可能遭遇伪装</p> <ul><li><p>解决办法</p> <ul><li>加入 SSL 层，验证来源证书</li></ul></li></ul></li> <li><p>无法证明报文的完整性，所以有可能已遭篡改</p> <ul><li><p>解决办法</p> <ul><li><p>MD5 和 SHA-1 等散列值校验</p></li> <li><p>数字签名方法</p></li></ul></li></ul></li></ul> <h3 id="何为-https"><a href="#何为-https" class="header-anchor">#</a> 何为 HTTPS</h3> <ul><li><p>HTTP + SSL = HTTPS</p></li> <li><p>HTTP + ( 加密 + 认证 + 完整性保护 ) = HTTPS</p></li> <li><p>身披 SSL 协议外壳的 HTTP，即是 HTTPS</p></li></ul> <p><img src="/code/note/book/25.jpg" alt=""></p> <ul><li><p>TSL 也是以 SSL 为原型开发的协议，有时会统一称该协议为 SSL</p></li> <li><p>HTTPS 采用混合加密机制 ( 共享密钥加密 + 公开密钥加密 )</p></li> <li><p>HTTPS 运用到的密匙需要数字证书认证机构通过</p></li></ul> <h3 id="https-缺点"><a href="#https-缺点" class="header-anchor">#</a> HTTPS 缺点</h3> <ul><li><p>基于 SSL 的 HTTPS 的通信速度比 HTTP 要慢 2~100 倍</p> <ul><li><p><strong>通信慢</strong> =&gt; SSL 协议通信增加了整体上处理通信量</p></li> <li><p><strong>处理速度慢</strong> =&gt; SSL 涉及加密处理，服务器/客户端都要进行加密/解密运算，导致负载增强</p></li> <li><p><strong>解决办法</strong> =&gt; SSL 加速器（专用服务器）硬件能一定程序上提高通信速度</p></li></ul></li> <li><p>免费的证书不多，会有证书购买的费用</p></li></ul> <h2 id="http-认证"><a href="#http-认证" class="header-anchor">#</a> HTTP 认证</h2> <ul><li>解决身份认证问题</li></ul> <h3 id="认证方式"><a href="#认证方式" class="header-anchor">#</a> 认证方式</h3> <ul><li><p>BASIC 认证（基本认证）</p></li> <li><p>DIGEST 认证（摘要认证）</p></li> <li><p>SSL 客户端认证</p></li> <li><p>FormBase 认证（基于表单认证）</p></li> <li><p>Keberos 认证</p></li> <li><p>NTLM 认证</p></li></ul> <h3 id="basic-认证"><a href="#basic-认证" class="header-anchor">#</a> BASIC 认证</h3> <ul><li><p>使用上不够便捷灵活</p></li> <li><p>直接发送明文，安全性等级不够，不太常用</p></li></ul> <p><img src="/code/note/book/26.jpg" alt=""></p> <p><img src="/code/note/book/27.jpg" alt=""></p> <h3 id="digest-认证"><a href="#digest-认证" class="header-anchor">#</a> DIGEST 认证</h3> <ul><li><p>使用质询/响应的方式</p></li> <li><p>一定程度上提高了安全性</p></li> <li><p>提供了防止密码被窃听的保护机制，但并不存在防止用户伪装的保护机制</p></li> <li><p>使用上仍然局限，因此适用范围也有所受限</p></li></ul> <p><img src="/code/note/book/28.jpg" alt=""></p> <p><img src="/code/note/book/29.jpg" alt=""></p> <h3 id="ssl-客户端认证"><a href="#ssl-客户端认证" class="header-anchor">#</a> SSL 客户端认证</h3> <ul><li><p>SSL 客户端认证是借由 HTTPS 的客户端证书完成认证的方式</p></li> <li><p>搭建时需要先将客户端证书分发给客户端，且客户端必须安装此证书</p></li> <li><p>采用双因素认证（与表单认证组合使用）</p></li> <li><p>因为用到证书，会产生一定的证书费用</p></li></ul> <h3 id="表单认证"><a href="#表单认证" class="header-anchor">#</a> 表单认证</h3> <ul><li><p>该方法并属于在 HTTP 协议中定义的，以客户端向服务器发送登录信息的结果认证</p></li> <li><p>根据 Web 应用程序的实际安装，提供的用户界面及认证方式也各不相同</p></li> <li><p>由于使用上的便利性及安全性问题，认证多半为基于表单认证</p></li> <li><p>基于表单认证的标准规范尚未有定论，一般会使用 Cookie 来管理 Session，实现认证</p></li></ul> <p><img src="/code/note/book/30.jpg" alt=""></p> <h2 id="http-追加协议"><a href="#http-追加协议" class="header-anchor">#</a> HTTP 追加协议</h2> <ul><li>解决协议不足的问题（拓展协议的能力）</li></ul> <h3 id="http-瓶颈"><a href="#http-瓶颈" class="header-anchor">#</a> HTTP 瓶颈</h3> <ul><li><p>一条连接上只可发送一个请求</p></li> <li><p>请求只能从客户端开始（客户端不可以接收除响应以外的指令）</p></li> <li><p>请求/响应首部未经压缩就发送（首部信息越多延迟越大）</p></li> <li><p>发送冗长的首部（每次互相发送相同的首部造成的浪费较多）</p></li> <li><p>可任意选择数据压缩格式（非强制压缩发送）</p></li></ul> <p><img src="/code/note/book/31.jpg" alt=""></p> <ul><li>Ajax 的解决办法</li></ul> <p><img src="/code/note/book/32.jpg" alt=""></p> <ul><li>Comet 的解决办法</li></ul> <p><img src="/code/note/book/33.jpg" alt=""></p> <ul><li>Ajax 和 Comet 提高了易用性，却没根本上解决 HTTP 协议本身的限制</li></ul> <h3 id="spdy"><a href="#spdy" class="header-anchor">#</a> SPDY</h3> <ul><li><p>没有完全改写 HTTP 协议，而是在应用层与运输层之间新加会话层来运作</p></li> <li><p>考虑到安全性问题，SPDY 规定通信中必须使用 SSL</p></li></ul> <p><img src="/code/note/book/34.jpg" alt=""></p> <ul><li><p>SPDY 对 HTTP 的功能拓展</p> <ul><li><p><strong>多路复用</strong> =&gt; 单一 TCP 连接，可以无限制处理多个 HTTP 请求</p></li> <li><p><strong>请求优先级</strong> =&gt; 可以给请求逐个分配优先级顺序</p></li> <li><p><strong>HTTP 首部压缩</strong> =&gt; 数据包数量和发送字节数减少了</p></li> <li><p><strong>推送功能</strong> =&gt; 支持服务器主动向客户端推送数据</p></li> <li><p><strong>服务器提示</strong> =&gt; 服务器可以主动提示客户端请求所需的资源</p></li></ul></li> <li><p>SPDY 技术应用进展不佳</p> <ul><li>只是单域名通信的多路复用，当 1 个 Web 站上使用多个域名资源，改善效果就会受限</li></ul></li></ul> <h3 id="websocket"><a href="#websocket" class="header-anchor">#</a> WebSocket</h3> <ul><li><p>建立在 HTTP 基础上的协议，属于浏览器与服务器之间的全双工通信标准</p></li> <li><p>协议由 IETF 定为标准，WebSocket API 由 W3C 定为标准</p></li> <li><p>一旦建立起 WebSocket 通信连接，之后会一直保持连接状态</p></li> <li><p>不论服务器还是客户端，任意一方都可直接向对方发送报文</p></li> <li><p>协议的功能特点</p> <ul><li><p>推送功能 =&gt; 支持服务器主动向客户端推送数据</p></li> <li><p>减少通信量 =&gt; 由于 WebSocket 首部信息很小，通信量也相应减少了</p></li></ul></li> <li><p>在 HTTP 连接建立之后，需要完成一次“握手”的步骤</p></li></ul> <p><img src="/code/note/book/35.png" alt=""></p> <h3 id="http2-0"><a href="#http2-0" class="header-anchor">#</a> HTTP2.0</h3> <ul><li><p>可以说是 SPDY 的升级版，其实原本也是基于 SPDY 设计的</p></li> <li><p>与 HTTP1.x 相比</p> <ul><li><p>新的二进制格式</p></li> <li><p>多路复用</p></li> <li><p>HTTP 首部压缩</p></li> <li><p>服务端推送</p></li> <li><p>更安全的 SSL</p></li></ul></li></ul> <h3 id="webdav"><a href="#webdav" class="header-anchor">#</a> WebDAV</h3> <ul><li><p>作为 HTTP/1.1 协议的扩展定义在 RFC4918</p></li> <li><p>一个可对 Web 服务器上的内容直接进行文件复制、编辑等操作的分布式文件系统</p></li> <li><p>除了创建、删除文件等基本功能，还具备文件加锁，对文件内容修改的版本控制功能</p></li></ul> <p><img src="/code/note/book/36.png" alt=""></p> <ul><li><p>WebDAV 扩展概念</p> <ul><li><p>集合</p></li> <li><p>资源</p></li> <li><p>属性</p></li> <li><p>锁</p></li></ul></li> <li><p>WebDAV 新增方法</p> <ul><li><p>PROPFIND ：获取属性</p></li> <li><p>PROPPATCH ：修改属性</p></li> <li><p>MKCOL ：创建集合</p></li> <li><p>COPY ：复制资源及属性</p></li> <li><p>MOVE ：移动资源</p></li> <li><p>LOCK ：资源加锁</p></li> <li><p>UNLOCK ：资源解锁</p></li></ul></li> <li><p>WebDAV 状态码</p> <ul><li><p>102：可正常处理请求，但目前是处理中状态</p></li> <li><p>207：存在多种状态</p></li> <li><p>422：格式正确，内容有误</p></li> <li><p>423：资源已被加锁</p></li> <li><p>424：处理与某请求关联的请求失败，因此不再维持依赖关系</p></li> <li><p>507：保存空间不足</p></li></ul></li> <li><p>WebDAV 通信示例</p></li></ul> <p><img src="/code/note/book/37.png" alt=""></p> <p><img src="/code/note/book/38.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/personal-blog/code/note/book/1.html" class="prev">
        《ECMAScript6 入门》
      </a></span> <span class="next"><a href="/personal-blog/code/note/book/3.html">
        《你不知道的 javascript（上）》
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/personal-blog/assets/js/app.742ab6e9.js" defer></script><script src="/personal-blog/assets/js/2.b85b6bc1.js" defer></script><script src="/personal-blog/assets/js/40.8d4dbb06.js" defer></script>
  </body>
</html>
